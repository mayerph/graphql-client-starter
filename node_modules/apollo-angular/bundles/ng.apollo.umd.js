(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('rxjs/operators'), require('rxjs'), require('@angular/core'), require('apollo-client')) :
    typeof define === 'function' && define.amd ? define('apollo-angular', ['exports', 'rxjs/operators', 'rxjs', '@angular/core', 'apollo-client'], factory) :
    (factory((global['ng.apollo'] = {}),global.rxjs.operators,global.rxjs,global.ng.core,global.apollo));
}(this, (function (exports,operators,rxjs,core,apolloClient) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template T
     * @param {?} promiseFn
     * @return {?}
     */
    function fromPromise(promiseFn) {
        return new rxjs.Observable(function (subscriber) {
            promiseFn().then(function (result) {
                if (!subscriber.closed) {
                    subscriber.next(result);
                    subscriber.complete();
                }
            }, function (error) {
                if (!subscriber.closed) {
                    subscriber.error(error);
                }
            });
            return function () { return subscriber.unsubscribe(); };
        });
    }
    var ZoneScheduler = /** @class */ (function () {
        function ZoneScheduler(zone) {
            this.zone = zone;
            this.now = Date.now ? Date.now : function () { return +new Date(); };
        }
        /**
         * @template T
         * @param {?} work
         * @param {?=} delay
         * @param {?=} state
         * @return {?}
         */
        ZoneScheduler.prototype.schedule = /**
         * @template T
         * @param {?} work
         * @param {?=} delay
         * @param {?=} state
         * @return {?}
         */
            function (work, delay, state) {
                if (delay === void 0) {
                    delay = 0;
                }
                return ( /** @type {?} */(this.zone.run(function () {
                    return rxjs.queueScheduler.schedule(work, delay, state);
                })));
            };
        return ZoneScheduler;
    }());
    // XXX: Apollo's QueryObservable is not compatible with RxJS
    // TODO: remove it in one of future releases
    // https://github.com/ReactiveX/rxjs/blob/9fb0ce9e09c865920cf37915cc675e3b3a75050b/src/internal/util/subscribeTo.ts#L32
    /**
     * @template T
     * @param {?} obs
     * @return {?}
     */
    function fixObservable(obs) {
        (( /** @type {?} */(obs)))[rxjs.observable] = function () { return obs; };
        return obs;
    }
    /**
     * @template T
     * @param {?} obs
     * @param {?} ngZone
     * @return {?}
     */
    function wrapWithZone(obs, ngZone) {
        return obs.pipe(operators.observeOn(new ZoneScheduler(ngZone)));
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template T, V
     */
    var /**
     * @template T, V
     */ QueryRef = /** @class */ (function () {
        function QueryRef(obsQuery, ngZone) {
            this.obsQuery = obsQuery;
            this.valueChanges = wrapWithZone(rxjs.from(fixObservable(this.obsQuery)), ngZone);
            this.queryId = this.obsQuery.queryId;
        }
        // ObservableQuery's methods
        // ObservableQuery's methods
        /**
         * @return {?}
         */
        QueryRef.prototype.result =
            // ObservableQuery's methods
            /**
             * @return {?}
             */
            function () {
                return this.obsQuery.result();
            };
        /**
         * @return {?}
         */
        QueryRef.prototype.currentResult = /**
         * @return {?}
         */
            function () {
                return this.obsQuery.currentResult();
            };
        /**
         * @return {?}
         */
        QueryRef.prototype.getLastResult = /**
         * @return {?}
         */
            function () {
                return this.obsQuery.getLastResult();
            };
        /**
         * @return {?}
         */
        QueryRef.prototype.getLastError = /**
         * @return {?}
         */
            function () {
                return this.obsQuery.getLastError();
            };
        /**
         * @return {?}
         */
        QueryRef.prototype.resetLastResults = /**
         * @return {?}
         */
            function () {
                return this.obsQuery.resetLastResults();
            };
        /**
         * @param {?=} variables
         * @return {?}
         */
        QueryRef.prototype.refetch = /**
         * @param {?=} variables
         * @return {?}
         */
            function (variables) {
                return this.obsQuery.refetch(variables);
            };
        /**
         * @template K
         * @param {?} fetchMoreOptions
         * @return {?}
         */
        QueryRef.prototype.fetchMore = /**
         * @template K
         * @param {?} fetchMoreOptions
         * @return {?}
         */
            function (fetchMoreOptions) {
                return this.obsQuery.fetchMore(fetchMoreOptions);
            };
        /**
         * @template MT, MV
         * @param {?} options
         * @return {?}
         */
        QueryRef.prototype.subscribeToMore = /**
         * @template MT, MV
         * @param {?} options
         * @return {?}
         */
            function (options) {
                // XXX: there's a bug in apollo-client typings
                // it should not inherit types from ObservableQuery
                return this.obsQuery.subscribeToMore(( /** @type {?} */(options)));
            };
        /**
         * @param {?} mapFn
         * @return {?}
         */
        QueryRef.prototype.updateQuery = /**
         * @param {?} mapFn
         * @return {?}
         */
            function (mapFn) {
                return this.obsQuery.updateQuery(mapFn);
            };
        /**
         * @return {?}
         */
        QueryRef.prototype.stopPolling = /**
         * @return {?}
         */
            function () {
                return this.obsQuery.stopPolling();
            };
        /**
         * @param {?} pollInterval
         * @return {?}
         */
        QueryRef.prototype.startPolling = /**
         * @param {?} pollInterval
         * @return {?}
         */
            function (pollInterval) {
                return this.obsQuery.startPolling(pollInterval);
            };
        /**
         * @param {?} opts
         * @return {?}
         */
        QueryRef.prototype.setOptions = /**
         * @param {?} opts
         * @return {?}
         */
            function (opts) {
                return this.obsQuery.setOptions(opts);
            };
        /**
         * @param {?} variables
         * @param {?=} tryFetch
         * @param {?=} fetchResults
         * @return {?}
         */
        QueryRef.prototype.setVariables = /**
         * @param {?} variables
         * @param {?=} tryFetch
         * @param {?=} fetchResults
         * @return {?}
         */
            function (variables, tryFetch, fetchResults) {
                if (tryFetch === void 0) {
                    tryFetch = false;
                }
                if (fetchResults === void 0) {
                    fetchResults = true;
                }
                return this.obsQuery.setVariables(variables, tryFetch, fetchResults);
            };
        return QueryRef;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var APOLLO_OPTIONS = new core.InjectionToken('[apollo-angular] options');

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template TCacheShape
     */
    var /**
     * @template TCacheShape
     */ ApolloBase = /** @class */ (function () {
        function ApolloBase(ngZone, _client) {
            this.ngZone = ngZone;
            this._client = _client;
        }
        /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
        ApolloBase.prototype.watchQuery = /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
            function (options) {
                return new QueryRef(( /** @type {?} */(this.client.watchQuery(__assign({}, options)))), this.ngZone);
            };
        /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
        ApolloBase.prototype.query = /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
            function (options) {
                var _this = this;
                return fromPromise(function () {
                    return _this.client.query(__assign({}, options));
                });
            };
        /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
        ApolloBase.prototype.mutate = /**
         * @template T, V
         * @param {?} options
         * @return {?}
         */
            function (options) {
                var _this = this;
                return fromPromise(function () {
                    return _this.client.mutate(__assign({}, options));
                });
            };
        /**
         * @template T, V
         * @param {?} options
         * @param {?=} extra
         * @return {?}
         */
        ApolloBase.prototype.subscribe = /**
         * @template T, V
         * @param {?} options
         * @param {?=} extra
         * @return {?}
         */
            function (options, extra) {
                /** @type {?} */
                var obs = rxjs.from(fixObservable(this.client.subscribe(__assign({}, options))));
                return extra && extra.useZone !== true
                    ? obs
                    : wrapWithZone(obs, this.ngZone);
            };
        /**
         * @return {?}
         */
        ApolloBase.prototype.getClient = /**
         * @return {?}
         */
            function () {
                return this._client;
            };
        /**
         * @param {?} client
         * @return {?}
         */
        ApolloBase.prototype.setClient = /**
         * @param {?} client
         * @return {?}
         */
            function (client) {
                if (this._client) {
                    throw new Error('Client has been already defined');
                }
                this._client = client;
            };
        Object.defineProperty(ApolloBase.prototype, "client", {
            get: /**
             * @return {?}
             */ function () {
                this.beforeEach();
                return this._client;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        ApolloBase.prototype.beforeEach = /**
         * @return {?}
         */
            function () {
                this.checkInstance();
            };
        /**
         * @return {?}
         */
        ApolloBase.prototype.checkInstance = /**
         * @return {?}
         */
            function () {
                if (!this._client) {
                    throw new Error('Client has not been defined yet');
                }
            };
        return ApolloBase;
    }());
    var Apollo = /** @class */ (function (_super) {
        __extends(Apollo, _super);
        function Apollo(_ngZone, apolloOptions) {
            var _this = _super.call(this, _ngZone) || this;
            _this._ngZone = _ngZone;
            _this.map = new Map();
            if (apolloOptions) {
                _this.createDefault(apolloOptions);
            }
            return _this;
        }
        /**
         * @template TCacheShape
         * @param {?} options
         * @param {?=} name
         * @return {?}
         */
        Apollo.prototype.create = /**
         * @template TCacheShape
         * @param {?} options
         * @param {?=} name
         * @return {?}
         */
            function (options, name) {
                if (name && name !== 'default') {
                    this.createNamed(name, options);
                }
                else {
                    this.createDefault(options);
                }
            };
        /**
         * @return {?}
         */
        Apollo.prototype.default = /**
         * @return {?}
         */
            function () {
                return this;
            };
        /**
         * @param {?} name
         * @return {?}
         */
        Apollo.prototype.use = /**
         * @param {?} name
         * @return {?}
         */
            function (name) {
                if (name === 'default') {
                    return this.default();
                }
                return this.map.get(name);
            };
        /**
         * @template TCacheShape
         * @param {?} options
         * @return {?}
         */
        Apollo.prototype.createDefault = /**
         * @template TCacheShape
         * @param {?} options
         * @return {?}
         */
            function (options) {
                if (this.getClient()) {
                    throw new Error('Apollo has been already created.');
                }
                return this.setClient(new apolloClient.ApolloClient(options));
            };
        /**
         * @template TCacheShape
         * @param {?} name
         * @param {?} options
         * @return {?}
         */
        Apollo.prototype.createNamed = /**
         * @template TCacheShape
         * @param {?} name
         * @param {?} options
         * @return {?}
         */
            function (name, options) {
                if (this.map.has(name)) {
                    throw new Error("Client " + name + " has been already created");
                }
                this.map.set(name, new ApolloBase(this._ngZone, new apolloClient.ApolloClient(options)));
            };
        Apollo.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        Apollo.ctorParameters = function () {
            return [
                { type: core.NgZone },
                { type: undefined, decorators: [{ type: core.Optional }, { type: core.Inject, args: [APOLLO_OPTIONS,] }] }
            ];
        };
        return Apollo;
    }(ApolloBase));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template T, V
     */
    var Query = /** @class */ (function () {
        function Query(apollo) {
            this.apollo = apollo;
            this.client = 'default';
        }
        /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
        Query.prototype.watch = /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
            function (variables, options) {
                return this.apollo.use(this.client).watchQuery(__assign({}, options, { variables: variables, query: this.document }));
            };
        /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
        Query.prototype.fetch = /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
            function (variables, options) {
                return this.apollo.use(this.client).query(__assign({}, options, { variables: variables, query: this.document }));
            };
        Query.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        Query.ctorParameters = function () {
            return [
                { type: Apollo }
            ];
        };
        return Query;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template T, V
     */
    var Mutation = /** @class */ (function () {
        function Mutation(apollo) {
            this.apollo = apollo;
            this.client = 'default';
        }
        /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
        Mutation.prototype.mutate = /**
         * @param {?=} variables
         * @param {?=} options
         * @return {?}
         */
            function (variables, options) {
                return this.apollo.use(this.client).mutate(__assign({}, options, { variables: variables, mutation: this.document }));
            };
        Mutation.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        Mutation.ctorParameters = function () {
            return [
                { type: Apollo }
            ];
        };
        return Mutation;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @template T, V
     */
    var Subscription = /** @class */ (function () {
        function Subscription(apollo) {
            this.apollo = apollo;
            this.client = 'default';
        }
        /**
         * @param {?=} variables
         * @param {?=} options
         * @param {?=} extra
         * @return {?}
         */
        Subscription.prototype.subscribe = /**
         * @param {?=} variables
         * @param {?=} options
         * @param {?=} extra
         * @return {?}
         */
            function (variables, options, extra) {
                return this.apollo.use(this.client).subscribe(__assign({}, options, { variables: variables, query: this.document }), extra);
            };
        Subscription.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        Subscription.ctorParameters = function () {
            return [
                { type: Apollo }
            ];
        };
        return Subscription;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var SelectPipe = /** @class */ (function () {
        function SelectPipe() {
        }
        /**
         * @param {?} obj
         * @param {?=} name
         * @return {?}
         */
        SelectPipe.prototype.transform = /**
         * @param {?} obj
         * @param {?=} name
         * @return {?}
         */
            function (obj, name) {
                if (name === void 0) {
                    name = '';
                }
                if (name !== '') {
                    return obj && obj.data && obj.data[name];
                }
            };
        SelectPipe.decorators = [
            { type: core.Pipe, args: [{
                        name: 'select',
                    },] }
        ];
        return SelectPipe;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var PROVIDERS = [Apollo];
    /** @type {?} */
    var DECLARATIONS = [SelectPipe];
    var ApolloModule = /** @class */ (function () {
        function ApolloModule() {
        }
        ApolloModule.decorators = [
            { type: core.NgModule, args: [{
                        providers: PROVIDERS,
                        declarations: DECLARATIONS,
                        exports: DECLARATIONS,
                    },] }
        ];
        return ApolloModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.Apollo = Apollo;
    exports.ApolloBase = ApolloBase;
    exports.QueryRef = QueryRef;
    exports.Query = Query;
    exports.Mutation = Mutation;
    exports.Subscription = Subscription;
    exports.SelectPipe = SelectPipe;
    exports.ApolloModule = ApolloModule;
    exports.APOLLO_OPTIONS = APOLLO_OPTIONS;
    exports.ɵb = DECLARATIONS;
    exports.ɵa = PROVIDERS;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmcuYXBvbGxvLnVtZC5qcy5tYXAiLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJuZzovL2Fwb2xsby1hbmd1bGFyL3V0aWxzLnRzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci9RdWVyeVJlZi50cyIsIm5nOi8vYXBvbGxvLWFuZ3VsYXIvdG9rZW5zLnRzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci9BcG9sbG8udHMiLCJuZzovL2Fwb2xsby1hbmd1bGFyL1F1ZXJ5LnRzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci9NdXRhdGlvbi50cyIsIm5nOi8vYXBvbGxvLWFuZ3VsYXIvU3Vic2NyaXB0aW9uLnRzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci9TZWxlY3RQaXBlLnRzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci9BcG9sbG9Nb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJpbXBvcnQge05nWm9uZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge09ic2VydmFibGVRdWVyeX0gZnJvbSAnYXBvbGxvLWNsaWVudCc7XG5pbXBvcnQge09ic2VydmFibGUgYXMgQXBvbGxvT2JzZXJ2YWJsZX0gZnJvbSAnYXBvbGxvLWNsaWVudC91dGlsL09ic2VydmFibGUnO1xuaW1wb3J0IHtvYnNlcnZlT259IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7XG4gIE9ic2VydmFibGUsXG4gIFN1YnNjcmlwdGlvbixcbiAgcXVldWVTY2hlZHVsZXIsXG4gIFNjaGVkdWxlckxpa2UsXG4gIFNjaGVkdWxlckFjdGlvbixcbiAgb2JzZXJ2YWJsZSxcbn0gZnJvbSAncnhqcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJvbWlzZTxUPihwcm9taXNlRm46ICgpID0+IFByb21pc2U8VD4pOiBPYnNlcnZhYmxlPFQ+IHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFQ+KHN1YnNjcmliZXIgPT4ge1xuICAgIHByb21pc2VGbigpLnRoZW4oXG4gICAgICByZXN1bHQgPT4ge1xuICAgICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHJlc3VsdCk7XG4gICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXJyb3IgPT4ge1xuICAgICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiAoKSA9PiBzdWJzY3JpYmVyLnVuc3Vic2NyaWJlKCk7XG4gIH0pO1xufVxuXG5leHBvcnQgY2xhc3MgWm9uZVNjaGVkdWxlciBpbXBsZW1lbnRzIFNjaGVkdWxlckxpa2Uge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHpvbmU6IE5nWm9uZSkge31cblxuICBwdWJsaWMgbm93ID0gRGF0ZS5ub3cgPyBEYXRlLm5vdyA6ICgpID0+ICtuZXcgRGF0ZSgpO1xuXG4gIHB1YmxpYyBzY2hlZHVsZTxUPihcbiAgICB3b3JrOiAodGhpczogU2NoZWR1bGVyQWN0aW9uPFQ+LCBzdGF0ZT86IFQpID0+IHZvaWQsXG4gICAgZGVsYXk6IG51bWJlciA9IDAsXG4gICAgc3RhdGU/OiBULFxuICApOiBTdWJzY3JpcHRpb24ge1xuICAgIHJldHVybiB0aGlzLnpvbmUucnVuKCgpID0+XG4gICAgICBxdWV1ZVNjaGVkdWxlci5zY2hlZHVsZSh3b3JrLCBkZWxheSwgc3RhdGUpLFxuICAgICkgYXMgU3Vic2NyaXB0aW9uO1xuICB9XG59XG5cbi8vIFhYWDogQXBvbGxvJ3MgUXVlcnlPYnNlcnZhYmxlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggUnhKU1xuLy8gVE9ETzogcmVtb3ZlIGl0IGluIG9uZSBvZiBmdXR1cmUgcmVsZWFzZXNcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9SZWFjdGl2ZVgvcnhqcy9ibG9iLzlmYjBjZTllMDljODY1OTIwY2YzNzkxNWNjNjc1ZTNiM2E3NTA1MGIvc3JjL2ludGVybmFsL3V0aWwvc3Vic2NyaWJlVG8udHMjTDMyXG5leHBvcnQgZnVuY3Rpb24gZml4T2JzZXJ2YWJsZTxUPihcbiAgb2JzOiBPYnNlcnZhYmxlUXVlcnk8VD4gfCBBcG9sbG9PYnNlcnZhYmxlPFQ+LFxuKTogT2JzZXJ2YWJsZVF1ZXJ5PFQ+IHwgQXBvbGxvT2JzZXJ2YWJsZTxUPiB7XG4gIChvYnMgYXMgYW55KVtvYnNlcnZhYmxlXSA9ICgpID0+IG9icztcbiAgcmV0dXJuIG9icztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBXaXRoWm9uZTxUPihcbiAgb2JzOiBPYnNlcnZhYmxlPFQ+LFxuICBuZ1pvbmU6IE5nWm9uZSxcbik6IE9ic2VydmFibGU8VD4ge1xuICByZXR1cm4gb2JzLnBpcGUob2JzZXJ2ZU9uKG5ldyBab25lU2NoZWR1bGVyKG5nWm9uZSkpKTtcbn1cbiIsImltcG9ydCB7Tmdab25lfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFwb2xsb1F1ZXJ5UmVzdWx0LFxuICBPYnNlcnZhYmxlUXVlcnksXG4gIEFwb2xsb0Vycm9yLFxuICBGZXRjaE1vcmVRdWVyeU9wdGlvbnMsXG4gIEZldGNoTW9yZU9wdGlvbnMsXG4gIFN1YnNjcmliZVRvTW9yZU9wdGlvbnMsXG4gIFVwZGF0ZVF1ZXJ5T3B0aW9ucyxcbiAgQXBvbGxvQ3VycmVudFJlc3VsdCxcbn0gZnJvbSAnYXBvbGxvLWNsaWVudCc7XG5pbXBvcnQge09ic2VydmFibGUsIGZyb219IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge3dyYXBXaXRoWm9uZSwgZml4T2JzZXJ2YWJsZX0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge1J9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUXVlcnlSZWY8VCwgViA9IFI+IHtcbiAgcHVibGljIHZhbHVlQ2hhbmdlczogT2JzZXJ2YWJsZTxBcG9sbG9RdWVyeVJlc3VsdDxUPj47XG4gIHB1YmxpYyBxdWVyeUlkOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBvYnNRdWVyeTogT2JzZXJ2YWJsZVF1ZXJ5PFQsIFY+LCBuZ1pvbmU6IE5nWm9uZSkge1xuICAgIHRoaXMudmFsdWVDaGFuZ2VzID0gd3JhcFdpdGhab25lKFxuICAgICAgZnJvbShmaXhPYnNlcnZhYmxlKHRoaXMub2JzUXVlcnkpKSxcbiAgICAgIG5nWm9uZSxcbiAgICApO1xuICAgIHRoaXMucXVlcnlJZCA9IHRoaXMub2JzUXVlcnkucXVlcnlJZDtcbiAgfVxuXG4gIC8vIE9ic2VydmFibGVRdWVyeSdzIG1ldGhvZHNcblxuICBwdWJsaWMgcmVzdWx0KCk6IFByb21pc2U8QXBvbGxvUXVlcnlSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gdGhpcy5vYnNRdWVyeS5yZXN1bHQoKTtcbiAgfVxuXG4gIHB1YmxpYyBjdXJyZW50UmVzdWx0KCk6IEFwb2xsb0N1cnJlbnRSZXN1bHQ8VD4ge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LmN1cnJlbnRSZXN1bHQoKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRMYXN0UmVzdWx0KCk6IEFwb2xsb1F1ZXJ5UmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gdGhpcy5vYnNRdWVyeS5nZXRMYXN0UmVzdWx0KCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0TGFzdEVycm9yKCk6IEFwb2xsb0Vycm9yIHtcbiAgICByZXR1cm4gdGhpcy5vYnNRdWVyeS5nZXRMYXN0RXJyb3IoKTtcbiAgfVxuXG4gIHB1YmxpYyByZXNldExhc3RSZXN1bHRzKCk6IHZvaWQge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LnJlc2V0TGFzdFJlc3VsdHMoKTtcbiAgfVxuXG4gIHB1YmxpYyByZWZldGNoKHZhcmlhYmxlcz86IFYpOiBQcm9taXNlPEFwb2xsb1F1ZXJ5UmVzdWx0PFQ+PiB7XG4gICAgcmV0dXJuIHRoaXMub2JzUXVlcnkucmVmZXRjaCh2YXJpYWJsZXMpO1xuICB9XG5cbiAgcHVibGljIGZldGNoTW9yZTxLIGV4dGVuZHMga2V5b2YgVj4oXG4gICAgZmV0Y2hNb3JlT3B0aW9uczogRmV0Y2hNb3JlUXVlcnlPcHRpb25zPFYsIEs+ICYgRmV0Y2hNb3JlT3B0aW9uczxULCBWPixcbiAgKTogUHJvbWlzZTxBcG9sbG9RdWVyeVJlc3VsdDxUPj4ge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LmZldGNoTW9yZShmZXRjaE1vcmVPcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBzdWJzY3JpYmVUb01vcmU8TVQgPSBhbnksIE1WID0gUj4oXG4gICAgb3B0aW9uczogU3Vic2NyaWJlVG9Nb3JlT3B0aW9uczxNVCwgTVY+LFxuICApOiAoKSA9PiB2b2lkIHtcbiAgICAvLyBYWFg6IHRoZXJlJ3MgYSBidWcgaW4gYXBvbGxvLWNsaWVudCB0eXBpbmdzXG4gICAgLy8gaXQgc2hvdWxkIG5vdCBpbmhlcml0IHR5cGVzIGZyb20gT2JzZXJ2YWJsZVF1ZXJ5XG4gICAgcmV0dXJuIHRoaXMub2JzUXVlcnkuc3Vic2NyaWJlVG9Nb3JlKG9wdGlvbnMgYXMgYW55KTtcbiAgfVxuICBwdWJsaWMgdXBkYXRlUXVlcnkoXG4gICAgbWFwRm46IChwcmV2aW91c1F1ZXJ5UmVzdWx0OiBULCBvcHRpb25zOiBVcGRhdGVRdWVyeU9wdGlvbnM8Vj4pID0+IFQsXG4gICk6IHZvaWQge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LnVwZGF0ZVF1ZXJ5KG1hcEZuKTtcbiAgfVxuXG4gIHB1YmxpYyBzdG9wUG9sbGluZygpOiB2b2lkIHtcbiAgICByZXR1cm4gdGhpcy5vYnNRdWVyeS5zdG9wUG9sbGluZygpO1xuICB9XG5cbiAgcHVibGljIHN0YXJ0UG9sbGluZyhwb2xsSW50ZXJ2YWw6IG51bWJlcik6IHZvaWQge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LnN0YXJ0UG9sbGluZyhwb2xsSW50ZXJ2YWwpO1xuICB9XG5cbiAgcHVibGljIHNldE9wdGlvbnMob3B0czogYW55KTogUHJvbWlzZTxBcG9sbG9RdWVyeVJlc3VsdDxUPj4ge1xuICAgIHJldHVybiB0aGlzLm9ic1F1ZXJ5LnNldE9wdGlvbnMob3B0cyk7XG4gIH1cblxuICBwdWJsaWMgc2V0VmFyaWFibGVzKFxuICAgIHZhcmlhYmxlczogVixcbiAgICB0cnlGZXRjaDogYm9vbGVhbiA9IGZhbHNlLFxuICAgIGZldGNoUmVzdWx0cyA9IHRydWUsXG4gICk6IFByb21pc2U8QXBvbGxvUXVlcnlSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gdGhpcy5vYnNRdWVyeS5zZXRWYXJpYWJsZXModmFyaWFibGVzLCB0cnlGZXRjaCwgZmV0Y2hSZXN1bHRzKTtcbiAgfVxufVxuIiwiaW1wb3J0IHtJbmplY3Rpb25Ub2tlbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Fwb2xsb0NsaWVudE9wdGlvbnN9IGZyb20gJ2Fwb2xsby1jbGllbnQnO1xuXG5leHBvcnQgY29uc3QgQVBPTExPX09QVElPTlMgPSBuZXcgSW5qZWN0aW9uVG9rZW48QXBvbGxvQ2xpZW50T3B0aW9uczxhbnk+PihcbiAgJ1thcG9sbG8tYW5ndWxhcl0gb3B0aW9ucycsXG4pO1xuIiwiaW1wb3J0IHtJbmplY3RhYmxlLCBPcHRpb25hbCwgSW5qZWN0LCBOZ1pvbmV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgQXBvbGxvQ2xpZW50LFxuICBRdWVyeU9wdGlvbnMsXG4gIFdhdGNoUXVlcnlPcHRpb25zLFxuICBNdXRhdGlvbk9wdGlvbnMsXG4gIEFwb2xsb1F1ZXJ5UmVzdWx0LFxuICBTdWJzY3JpcHRpb25PcHRpb25zLFxuICBBcG9sbG9DbGllbnRPcHRpb25zLFxuICBPYnNlcnZhYmxlUXVlcnksXG59IGZyb20gJ2Fwb2xsby1jbGllbnQnO1xuaW1wb3J0IHtGZXRjaFJlc3VsdH0gZnJvbSAnYXBvbGxvLWxpbmsnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBmcm9tfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHtRdWVyeVJlZn0gZnJvbSAnLi9RdWVyeVJlZic7XG5pbXBvcnQge0V4dHJhU3Vic2NyaXB0aW9uT3B0aW9ucywgUn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge0FQT0xMT19PUFRJT05TfSBmcm9tICcuL3Rva2Vucyc7XG5pbXBvcnQge2Zyb21Qcm9taXNlLCB3cmFwV2l0aFpvbmUsIGZpeE9ic2VydmFibGV9IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgQXBvbGxvQmFzZTxUQ2FjaGVTaGFwZSA9IGFueT4ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxuICAgIHByaXZhdGUgX2NsaWVudD86IEFwb2xsb0NsaWVudDxUQ2FjaGVTaGFwZT4sXG4gICkge31cblxuICBwdWJsaWMgd2F0Y2hRdWVyeTxULCBWID0gUj4ob3B0aW9uczogV2F0Y2hRdWVyeU9wdGlvbnM8Vj4pOiBRdWVyeVJlZjxULCBWPiB7XG4gICAgcmV0dXJuIG5ldyBRdWVyeVJlZjxULCBWPihcbiAgICAgIHRoaXMuY2xpZW50LndhdGNoUXVlcnk8VCwgVj4oey4uLm9wdGlvbnN9KSBhcyBPYnNlcnZhYmxlUXVlcnk8VCwgVj4sXG4gICAgICB0aGlzLm5nWm9uZSxcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHF1ZXJ5PFQsIFYgPSBSPihcbiAgICBvcHRpb25zOiBRdWVyeU9wdGlvbnM8Vj4sXG4gICk6IE9ic2VydmFibGU8QXBvbGxvUXVlcnlSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gZnJvbVByb21pc2U8QXBvbGxvUXVlcnlSZXN1bHQ8VD4+KCgpID0+XG4gICAgICB0aGlzLmNsaWVudC5xdWVyeTxULCBWPih7Li4ub3B0aW9uc30pLFxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgbXV0YXRlPFQsIFYgPSBSPihcbiAgICBvcHRpb25zOiBNdXRhdGlvbk9wdGlvbnM8VCwgVj4sXG4gICk6IE9ic2VydmFibGU8RmV0Y2hSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gZnJvbVByb21pc2U8RmV0Y2hSZXN1bHQ8VD4+KCgpID0+XG4gICAgICB0aGlzLmNsaWVudC5tdXRhdGU8VCwgVj4oey4uLm9wdGlvbnN9KSxcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHN1YnNjcmliZTxULCBWID0gUj4oXG4gICAgb3B0aW9uczogU3Vic2NyaXB0aW9uT3B0aW9uczxWPixcbiAgICBleHRyYT86IEV4dHJhU3Vic2NyaXB0aW9uT3B0aW9ucyxcbiAgKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBjb25zdCBvYnMgPSBmcm9tKGZpeE9ic2VydmFibGUodGhpcy5jbGllbnQuc3Vic2NyaWJlPFQsIFY+KHsuLi5vcHRpb25zfSkpKTtcblxuICAgIHJldHVybiBleHRyYSAmJiBleHRyYS51c2Vab25lICE9PSB0cnVlXG4gICAgICA/IG9ic1xuICAgICAgOiB3cmFwV2l0aFpvbmUob2JzLCB0aGlzLm5nWm9uZSk7XG4gIH1cblxuICBwdWJsaWMgZ2V0Q2xpZW50KCkge1xuICAgIHJldHVybiB0aGlzLl9jbGllbnQ7XG4gIH1cblxuICBwdWJsaWMgc2V0Q2xpZW50KGNsaWVudDogQXBvbGxvQ2xpZW50PFRDYWNoZVNoYXBlPikge1xuICAgIGlmICh0aGlzLl9jbGllbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xpZW50IGhhcyBiZWVuIGFscmVhZHkgZGVmaW5lZCcpO1xuICAgIH1cblxuICAgIHRoaXMuX2NsaWVudCA9IGNsaWVudDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGNsaWVudCgpOiBBcG9sbG9DbGllbnQ8VENhY2hlU2hhcGU+IHtcbiAgICB0aGlzLmJlZm9yZUVhY2goKTtcblxuICAgIHJldHVybiB0aGlzLl9jbGllbnQ7XG4gIH1cblxuICBwcml2YXRlIGJlZm9yZUVhY2goKTogdm9pZCB7XG4gICAgdGhpcy5jaGVja0luc3RhbmNlKCk7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrSW5zdGFuY2UoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9jbGllbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xpZW50IGhhcyBub3QgYmVlbiBkZWZpbmVkIHlldCcpO1xuICAgIH1cbiAgfVxufVxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQXBvbGxvIGV4dGVuZHMgQXBvbGxvQmFzZTxhbnk+IHtcbiAgcHJpdmF0ZSBtYXA6IE1hcDxzdHJpbmcsIEFwb2xsb0Jhc2U8YW55Pj4gPSBuZXcgTWFwPFxuICAgIHN0cmluZyxcbiAgICBBcG9sbG9CYXNlPGFueT5cbiAgPigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgX25nWm9uZTogTmdab25lLFxuICAgIEBPcHRpb25hbCgpXG4gICAgQEluamVjdChBUE9MTE9fT1BUSU9OUylcbiAgICBhcG9sbG9PcHRpb25zPzogQXBvbGxvQ2xpZW50T3B0aW9uczxhbnk+LFxuICApIHtcbiAgICBzdXBlcihfbmdab25lKTtcblxuICAgIGlmIChhcG9sbG9PcHRpb25zKSB7XG4gICAgICB0aGlzLmNyZWF0ZURlZmF1bHQoYXBvbGxvT3B0aW9ucyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGNyZWF0ZTxUQ2FjaGVTaGFwZT4oXG4gICAgb3B0aW9uczogQXBvbGxvQ2xpZW50T3B0aW9uczxUQ2FjaGVTaGFwZT4sXG4gICAgbmFtZT86IHN0cmluZyxcbiAgKTogdm9pZCB7XG4gICAgaWYgKG5hbWUgJiYgbmFtZSAhPT0gJ2RlZmF1bHQnKSB7XG4gICAgICB0aGlzLmNyZWF0ZU5hbWVkPFRDYWNoZVNoYXBlPihuYW1lLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jcmVhdGVEZWZhdWx0PFRDYWNoZVNoYXBlPihvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZGVmYXVsdCgpOiBBcG9sbG9CYXNlPGFueT4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIHVzZShuYW1lOiBzdHJpbmcpOiBBcG9sbG9CYXNlPGFueT4ge1xuICAgIGlmIChuYW1lID09PSAnZGVmYXVsdCcpIHtcbiAgICAgIHJldHVybiB0aGlzLmRlZmF1bHQoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubWFwLmdldChuYW1lKTtcbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVEZWZhdWx0PFRDYWNoZVNoYXBlPihcbiAgICBvcHRpb25zOiBBcG9sbG9DbGllbnRPcHRpb25zPFRDYWNoZVNoYXBlPixcbiAgKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZ2V0Q2xpZW50KCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXBvbGxvIGhhcyBiZWVuIGFscmVhZHkgY3JlYXRlZC4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zZXRDbGllbnQobmV3IEFwb2xsb0NsaWVudDxUQ2FjaGVTaGFwZT4ob3B0aW9ucykpO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZU5hbWVkPFRDYWNoZVNoYXBlPihcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgb3B0aW9uczogQXBvbGxvQ2xpZW50T3B0aW9uczxUQ2FjaGVTaGFwZT4sXG4gICk6IHZvaWQge1xuICAgIGlmICh0aGlzLm1hcC5oYXMobmFtZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2xpZW50ICR7bmFtZX0gaGFzIGJlZW4gYWxyZWFkeSBjcmVhdGVkYCk7XG4gICAgfVxuICAgIHRoaXMubWFwLnNldChcbiAgICAgIG5hbWUsXG4gICAgICBuZXcgQXBvbGxvQmFzZSh0aGlzLl9uZ1pvbmUsIG5ldyBBcG9sbG9DbGllbnQ8VENhY2hlU2hhcGU+KG9wdGlvbnMpKSxcbiAgICApO1xuICB9XG59XG4iLCJpbXBvcnQge0luamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtEb2N1bWVudE5vZGV9IGZyb20gJ2dyYXBocWwnO1xuaW1wb3J0IHtBcG9sbG9RdWVyeVJlc3VsdH0gZnJvbSAnYXBvbGxvLWNsaWVudCc7XG5pbXBvcnQge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge0Fwb2xsb30gZnJvbSAnLi9BcG9sbG8nO1xuaW1wb3J0IHtRdWVyeVJlZn0gZnJvbSAnLi9RdWVyeVJlZic7XG5pbXBvcnQge1dhdGNoUXVlcnlPcHRpb25zLCBRdWVyeU9wdGlvbnMsIFJ9IGZyb20gJy4vdHlwZXMnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgUXVlcnk8VCA9IHt9LCBWID0gUj4ge1xuICBwdWJsaWMgcmVhZG9ubHkgZG9jdW1lbnQ6IERvY3VtZW50Tm9kZTtcbiAgcHVibGljIGNsaWVudCA9ICdkZWZhdWx0JztcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgYXBvbGxvOiBBcG9sbG8pIHt9XG5cbiAgcHVibGljIHdhdGNoKHZhcmlhYmxlcz86IFYsIG9wdGlvbnM/OiBXYXRjaFF1ZXJ5T3B0aW9uczxWPik6IFF1ZXJ5UmVmPFQsIFY+IHtcbiAgICByZXR1cm4gdGhpcy5hcG9sbG8udXNlKHRoaXMuY2xpZW50KS53YXRjaFF1ZXJ5PFQsIFY+KHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB2YXJpYWJsZXMsXG4gICAgICBxdWVyeTogdGhpcy5kb2N1bWVudCxcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBmZXRjaChcbiAgICB2YXJpYWJsZXM/OiBWLFxuICAgIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnM8Vj4sXG4gICk6IE9ic2VydmFibGU8QXBvbGxvUXVlcnlSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gdGhpcy5hcG9sbG8udXNlKHRoaXMuY2xpZW50KS5xdWVyeTxULCBWPih7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgdmFyaWFibGVzLFxuICAgICAgcXVlcnk6IHRoaXMuZG9jdW1lbnQsXG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0RvY3VtZW50Tm9kZX0gZnJvbSAnZ3JhcGhxbCc7XG5pbXBvcnQge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtGZXRjaFJlc3VsdH0gZnJvbSAnYXBvbGxvLWxpbmsnO1xuXG5pbXBvcnQge0Fwb2xsb30gZnJvbSAnLi9BcG9sbG8nO1xuaW1wb3J0IHtNdXRhdGlvbk9wdGlvbnMsIFJ9IGZyb20gJy4vdHlwZXMnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTXV0YXRpb248VCA9IHt9LCBWID0gUj4ge1xuICBwdWJsaWMgcmVhZG9ubHkgZG9jdW1lbnQ6IERvY3VtZW50Tm9kZTtcbiAgcHVibGljIGNsaWVudCA9ICdkZWZhdWx0JztcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgYXBvbGxvOiBBcG9sbG8pIHt9XG5cbiAgcHVibGljIG11dGF0ZShcbiAgICB2YXJpYWJsZXM/OiBWLFxuICAgIG9wdGlvbnM/OiBNdXRhdGlvbk9wdGlvbnM8VCwgVj4sXG4gICk6IE9ic2VydmFibGU8RmV0Y2hSZXN1bHQ8VD4+IHtcbiAgICByZXR1cm4gdGhpcy5hcG9sbG8udXNlKHRoaXMuY2xpZW50KS5tdXRhdGU8VCwgVj4oe1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIHZhcmlhYmxlcyxcbiAgICAgIG11dGF0aW9uOiB0aGlzLmRvY3VtZW50LFxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQge0luamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtEb2N1bWVudE5vZGV9IGZyb20gJ2dyYXBocWwnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHtBcG9sbG99IGZyb20gJy4vQXBvbGxvJztcbmltcG9ydCB7XG4gIFN1YnNjcmlwdGlvbk9wdGlvbnMsXG4gIEV4dHJhU3Vic2NyaXB0aW9uT3B0aW9ucyxcbiAgU3Vic2NyaXB0aW9uUmVzdWx0LFxuICBSLFxufSBmcm9tICcuL3R5cGVzJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdGlvbjxUID0gYW55LCBWID0gUj4ge1xuICBwdWJsaWMgcmVhZG9ubHkgZG9jdW1lbnQ6IERvY3VtZW50Tm9kZTtcbiAgcHVibGljIGNsaWVudCA9ICdkZWZhdWx0JztcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgYXBvbGxvOiBBcG9sbG8pIHt9XG5cbiAgcHVibGljIHN1YnNjcmliZShcbiAgICB2YXJpYWJsZXM/OiBWLFxuICAgIG9wdGlvbnM/OiBTdWJzY3JpcHRpb25PcHRpb25zPFY+LFxuICAgIGV4dHJhPzogRXh0cmFTdWJzY3JpcHRpb25PcHRpb25zLFxuICApOiBPYnNlcnZhYmxlPFN1YnNjcmlwdGlvblJlc3VsdDxUPj4ge1xuICAgIHJldHVybiB0aGlzLmFwb2xsby51c2UodGhpcy5jbGllbnQpLnN1YnNjcmliZTxULCBWPihcbiAgICAgIHtcbiAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgdmFyaWFibGVzLFxuICAgICAgICBxdWVyeTogdGhpcy5kb2N1bWVudCxcbiAgICAgIH0sXG4gICAgICBleHRyYSxcbiAgICApO1xuICB9XG59XG4iLCJpbXBvcnQge1BpcGUsIFBpcGVUcmFuc2Zvcm19IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5AUGlwZSh7XG4gIG5hbWU6ICdzZWxlY3QnLFxufSlcbmV4cG9ydCBjbGFzcyBTZWxlY3RQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XG4gIHB1YmxpYyB0cmFuc2Zvcm0ob2JqOiBhbnksIG5hbWU6IHN0cmluZyA9ICcnKSB7XG4gICAgaWYgKG5hbWUgIT09ICcnKSB7XG4gICAgICByZXR1cm4gb2JqICYmIG9iai5kYXRhICYmIG9iai5kYXRhW25hbWVdO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHtOZ01vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7QXBvbGxvfSBmcm9tICcuL0Fwb2xsbyc7XG5pbXBvcnQge1NlbGVjdFBpcGV9IGZyb20gJy4vU2VsZWN0UGlwZSc7XG5cbmV4cG9ydCBjb25zdCBQUk9WSURFUlMgPSBbQXBvbGxvXTtcbmV4cG9ydCBjb25zdCBERUNMQVJBVElPTlMgPSBbU2VsZWN0UGlwZV07XG5cbkBOZ01vZHVsZSh7XG4gIHByb3ZpZGVyczogUFJPVklERVJTLFxuICBkZWNsYXJhdGlvbnM6IERFQ0xBUkFUSU9OUyxcbiAgZXhwb3J0czogREVDTEFSQVRJT05TLFxufSlcbmV4cG9ydCBjbGFzcyBBcG9sbG9Nb2R1bGUge31cbiJdLCJuYW1lcyI6WyJPYnNlcnZhYmxlIiwicXVldWVTY2hlZHVsZXIiLCJvYnNlcnZhYmxlIiwib2JzZXJ2ZU9uIiwiZnJvbSIsIkluamVjdGlvblRva2VuIiwidHNsaWJfMS5fX2V4dGVuZHMiLCJBcG9sbG9DbGllbnQiLCJJbmplY3RhYmxlIiwiTmdab25lIiwiT3B0aW9uYWwiLCJJbmplY3QiLCJQaXBlIiwiTmdNb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztJQWNBO0lBRUEsSUFBSSxhQUFhLEdBQUcsVUFBUyxDQUFDLEVBQUUsQ0FBQztRQUM3QixhQUFhLEdBQUcsTUFBTSxDQUFDLGNBQWM7YUFDaEMsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFF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