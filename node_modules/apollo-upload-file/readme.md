![Apollo upload logo](https://cdn.rawgit.com/jaydenseric/apollo-upload-client/27b1f20/apollo-upload-logo.svg)

# apollo-upload-file

[![npm version](https://img.shields.io/npm/v/apollo-upload-file.svg)](https://npm.im/apollo-upload-file) ![Licence](https://img.shields.io/npm/l/apollo-upload-client.svg) [![Github issues](https://img.shields.io/github/issues/saied-za/apollo-upload-client.svg)](https://github.com/saied-za/apollo-upload-client/issues) [![Github stars](https://img.shields.io/github/stars/saied-za/apollo-upload-client.svg)](https://github.com/saied-za/apollo-upload-client/stargazers)

Enhances [Apollo](https://apollographql.com) for intuitive file uploads via GraphQL queries or mutations. Use with a GraphQL multipart request spec server implementation, Where multipart requests are supported and operationName, query and variables are expected as request body context at the backend.
## Setup

Install with peer dependencies using [npm](https://npmjs.com):

```shell
npm install apollo-upload-file apollo-link
```

Initialize Apollo Client with this terminating link:

```js
import { createUploadLink } from 'apollo-upload-file'

const link = createUploadLink(/* Options */)
```

### Options

`createUploadLink` options match [`createHttpLink` options](https://www.apollographql.com/docs/link/links/http.html#Options):

* `includeExtensions` (boolean): Toggles sending `extensions` fields to the GraphQL server. (default: `false`).
* `uri` (string): GraphQL endpoint URI (default: `/graphql`).
* `credentials` (string): Overrides `fetchOptions.credentials`.
* `headers` (object): Merges with and overrides `fetchOptions.headers`.
* `fetchOptions` (object): [`fetch` init](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters); overridden by upload requirements.
* `fetch` (function): [Fetch API](https://fetch.spec.whatwg.org) to use (default: Global `fetch`).

## Usage

Use [`FileList`](https://developer.mozilla.org/en/docs/Web/API/FileList), [`File`](https://developer.mozilla.org/en/docs/Web/API/File), [`Blob`](https://developer.mozilla.org/en/docs/Web/API/Blob) or [`ReactNativeFile`](#react-native) instances anywhere within query or mutation input variables to send a GraphQL multipart request.

## Example
Consider a situation where you need to create a user and upload it's resume. following mutation is what you would give to the apollo instance.

    mutation createUser ($username: String!, $password: String!)
    {
      createUser(username: $username, password: $password)
      {
        user
        {
          id
        }
      }
    }

And this is what you would give to mutate function as input.

    apollo.mutate({
      mutation: CREATE_USER_MUTATION ,
      variables: {
        username: username,
        password: password,
        resume: userResumeFile
      }
    })
As you can see it is only needed to provide the file (in this case our resume) to the 'variables' field of mutate input object, and not to the actual CREATE_USER_MUTATION constant itself.

It is possible to change the name of file/files in the request, you just need to replace 'resume' key in variables object in the mutate function (in the example given) with whatever you want.

the resume given to the mutate function can be an array of files, in this case for each file, an index is appended to the key of file (in this case 'resume') -> resume_1, resume_2, ... .

## Support

* Node.js v6.10+, see `package.json` `engines`.
* [Browsers >1% usage](http://browserl.ist/?q=%3E1%25), see `package.json` `browserslist`.
* Angular >= 2.
* React Native.
